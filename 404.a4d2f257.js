function t(){const t=this,e=["init"];t.add=t=>{t.forEach((t=>e.push(t)))},t.check=t=>{let n=0;return t.forEach((t=>{n+=e.includes(t)?1:0})),n>0},t.checkNone=()=>0===e.length,t.clear=()=>{e.splice(0,e.length)}}function e(t,e){const n=this;let i={};const r=[],{canvas:s}=t;function o(t,e){const n=t.o.x-e.x,i=t.o.y-e.y;if(t.p.isCircle){const{r:e}=t.g;return n*n+i*i<e*e}if(t.p.isSquare){const{w:e,h:r}=t.g;return Math.abs(n)<.5*e&&Math.abs(i)<.5*r}return!1}n.newSquareHandle=function(t,e){r.push({o:t,g:e,p:{isSquare:!0}})},n.newCircleHandle=function(t,e){r.push({o:t,g:e,p:{isCircle:!0}})},n.clear=()=>{r.splice(0,r.length)},s.onmousedown=function(t){const e={};e.x=t.offsetX,e.y=t.offsetY;const n=r.length;for(let t=0;t<n;t++){const n=r[t];if(o(n,e)){i.iDragging=t,i.isDragging=!0,i.offX=n.o.x-e.x,i.offY=n.o.y-e.y,n.g.pickUp(),s.dataset.cursor="grabbing";break}}},s.onmouseup=function(){if(void 0!==i.iDragging){r[i.iDragging].g.drop()}i={}},s.onmousemove=function(t){const n={};if(n.x=t.offsetX,n.y=t.offsetY,i.isDragging){const t=r[i.iDragging];t.o.setX(n.x+i.offX),t.o.setY(n.y+i.offY),e.add(["draggables"])}else{const t=r.length;for(let e=0;e<t;e++){if(o(r[e],n))return void(s.dataset.cursor="grab")}s.dataset.cursor=""}}}function n(t,e){const n=this;n.width=t,n.height=e,n.canvas=document.createElement("canvas"),n.canvas.setAttribute("class","interactive"),n.ctx=n.canvas.getContext("2d"),n.noBuffers=!1,n.pixelRatio=function(t){const e=t.backingStorePixelRatio||t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return(window.devicePixelRatio||1)/e}
/*!!
 *  Canvas 2 Svg v1.0.19
 *  A low level canvas to SVG converter. Uses a mock canvas context to build an SVG document.
 *
 *  Licensed under the MIT license:
 *  http://www.opensource.org/licenses/mit-license.php
 *
 *  Author:
 *  Kerry Liu
 *
 *  Copyright (c) 2014 Gliffy Inc.
 */(n.ctx),n.canvas.width=t*n.pixelRatio,n.canvas.height=e*n.pixelRatio,n.canvas.style.width=`${t}px`,n.canvas.style.height=`${e}px`,n.ctx.scale(n.pixelRatio,n.pixelRatio),n.clear=function(){n.ctx.clearRect(0,0,n.canvas.width,n.canvas.height)},n.setCtx=function(t){n.ctx=t},n.setNoBuffers=function(t){n.noBuffers=t}}var i,r,s,o,a;function l(t,e){var n,i=Object.keys(e);for(n=0;n<i.length;n++)t=t.replace(new RegExp("\\{"+i[n]+"\\}","gi"),e[i[n]]);return t}function h(t){var e,n,i;if(!t)throw new Error("cannot create a random attribute name for an undefined object");e="ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",n="";do{for(n="",i=0;i<12;i++)n+=e[Math.floor(Math.random()*e.length)]}while(t[n]);return n}function c(t){var e={alphabetic:"alphabetic",hanging:"hanging",top:"text-before-edge",bottom:"text-after-edge",middle:"central"};return e[t]||e.alphabetic}a=function(t,e){var n,i,r,s={};for(t=t.split(","),e=e||10,n=0;n<t.length;n+=2)i="&"+t[n+1]+";",r=parseInt(t[n],e),s[i]="&#"+r+";";return s["\\xa0"]="&#160;",s}("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32),i={strokeStyle:{svgAttr:"stroke",canvas:"#000000",svg:"none",apply:"stroke"},fillStyle:{svgAttr:"fill",canvas:"#000000",svg:null,apply:"fill"},lineCap:{svgAttr:"stroke-linecap",canvas:"butt",svg:"butt",apply:"stroke"},lineJoin:{svgAttr:"stroke-linejoin",canvas:"miter",svg:"miter",apply:"stroke"},miterLimit:{svgAttr:"stroke-miterlimit",canvas:10,svg:4,apply:"stroke"},lineWidth:{svgAttr:"stroke-width",canvas:1,svg:1,apply:"stroke"},globalAlpha:{svgAttr:"opacity",canvas:1,svg:1,apply:"fill stroke"},font:{canvas:"10px sans-serif"},shadowColor:{canvas:"#000000"},shadowOffsetX:{canvas:0},shadowOffsetY:{canvas:0},shadowBlur:{canvas:0},textAlign:{canvas:"start"},textBaseline:{canvas:"alphabetic"},lineDash:{svgAttr:"stroke-dasharray",canvas:[],svg:null,apply:"stroke"}},s=function(t,e){this.__root=t,this.__ctx=e},s.prototype.addColorStop=function(t,e){var n,i=this.__ctx.__createElement("stop");i.setAttribute("offset",t),-1!==e.indexOf("rgba")?(n=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?\.?\d*)\s*\)/gi.exec(e),i.setAttribute("stop-color",l("rgb({r},{g},{b})",{r:n[1],g:n[2],b:n[3]})),i.setAttribute("stop-opacity",n[4])):i.setAttribute("stop-color",e),this.__root.appendChild(i)},o=function(t,e){this.__root=t,this.__ctx=e},(r=function(t){var e,n={width:500,height:500,enableMirroring:!1};if(arguments.length>1?((e=n).width=arguments[0],e.height=arguments[1]):e=t||n,!(this instanceof r))return new r(e);this.width=e.width||n.width,this.height=e.height||n.height,this.enableMirroring=void 0!==e.enableMirroring?e.enableMirroring:n.enableMirroring,this.canvas=this,this.__document=e.document||document,e.ctx?this.__ctx=e.ctx:(this.__canvas=this.__document.createElement("canvas"),this.__ctx=this.__canvas.getContext("2d")),this.__setDefaultStyles(),this.__stack=[this.__getStyleState()],this.__groupStack=[],this.__root=this.__document.createElementNS("http://www.w3.org/2000/svg","svg"),this.__root.setAttribute("version",1.1),this.__root.setAttribute("xmlns","http://www.w3.org/2000/svg"),this.__root.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),this.__root.setAttribute("width",this.width),this.__root.setAttribute("height",this.height),this.__ids={},this.__defs=this.__document.createElementNS("http://www.w3.org/2000/svg","defs"),this.__root.appendChild(this.__defs),this.__currentElement=this.__document.createElementNS("http://www.w3.org/2000/svg","g"),this.__root.appendChild(this.__currentElement)}).prototype.__createElement=function(t,e,n){void 0===e&&(e={});var i,r,s=this.__document.createElementNS("http://www.w3.org/2000/svg",t),o=Object.keys(e);for(n&&(s.setAttribute("fill","none"),s.setAttribute("stroke","none")),i=0;i<o.length;i++)r=o[i],s.setAttribute(r,e[r]);return s},r.prototype.__setDefaultStyles=function(){var t,e,n=Object.keys(i);for(t=0;t<n.length;t++)this[e=n[t]]=i[e].canvas},r.prototype.__applyStyleState=function(t){var e,n,i=Object.keys(t);for(e=0;e<i.length;e++)this[n=i[e]]=t[n]},r.prototype.__getStyleState=function(){var t,e,n={},r=Object.keys(i);for(t=0;t<r.length;t++)n[e=r[t]]=this[e];return n},r.prototype.__applyStyleToCurrentElement=function(t){var e=this.__currentElement,n=this.__currentElementsToStyle;n&&(e.setAttribute(t,""),e=n.element,n.children.forEach((function(e){e.setAttribute(t,"")})));var r,a,h,c,u,d=Object.keys(i);for(r=0;r<d.length;r++)if(a=i[d[r]],h=this[d[r]],a.apply)if(h instanceof o){if(h.__ctx)for(;h.__ctx.__defs.childNodes.length;)c=h.__ctx.__defs.childNodes[0].getAttribute("id"),this.__ids[c]=c,this.__defs.appendChild(h.__ctx.__defs.childNodes[0]);e.setAttribute(a.apply,l("url(#{id})",{id:h.__root.getAttribute("id")}))}else if(h instanceof s)e.setAttribute(a.apply,l("url(#{id})",{id:h.__root.getAttribute("id")}));else if(-1!==a.apply.indexOf(t)&&a.svg!==h)if("stroke"!==a.svgAttr&&"fill"!==a.svgAttr||-1===h.indexOf("rgba")){var f=a.svgAttr;if("globalAlpha"===d[r]&&(f=t+"-"+a.svgAttr,e.getAttribute(f)))continue;e.setAttribute(f,h)}else{u=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?\.?\d*)\s*\)/gi.exec(h),e.setAttribute(a.svgAttr,l("rgb({r},{g},{b})",{r:u[1],g:u[2],b:u[3]}));var p=u[4],_=this.globalAlpha;null!=_&&(p*=_),e.setAttribute(a.svgAttr+"-opacity",p)}},r.prototype.__closestGroupOrSvg=function(t){return"g"===(t=t||this.__currentElement).nodeName||"svg"===t.nodeName?t:this.__closestGroupOrSvg(t.parentNode)},r.prototype.getSerializedSvg=function(t){var e,n,i,r,s,o=(new XMLSerializer).serializeToString(this.__root);if(/xmlns="http:\/\/www\.w3\.org\/2000\/svg".+xmlns="http:\/\/www\.w3\.org\/2000\/svg/gi.test(o)&&(o=o.replace('xmlns="http://www.w3.org/2000/svg','xmlns:xlink="http://www.w3.org/1999/xlink')),t)for(e=Object.keys(a),n=0;n<e.length;n++)i=e[n],r=a[i],(s=new RegExp(i,"gi")).test(o)&&(o=o.replace(s,r));return o},r.prototype.getSvg=function(){return this.__root},r.prototype.save=function(){var t=this.__createElement("g"),e=this.__closestGroupOrSvg();this.__groupStack.push(e),e.appendChild(t),this.__currentElement=t,this.__stack.push(this.__getStyleState())},r.prototype.restore=function(){this.__currentElement=this.__groupStack.pop(),this.__currentElementsToStyle=null,this.__currentElement||(this.__currentElement=this.__root.childNodes[1]);var t=this.__stack.pop();this.__applyStyleState(t)},r.prototype.__addTransform=function(t){var e=this.__closestGroupOrSvg();if(e.childNodes.length>0){"path"===this.__currentElement.nodeName&&(this.__currentElementsToStyle||(this.__currentElementsToStyle={element:e,children:[]}),this.__currentElementsToStyle.children.push(this.__currentElement),this.__applyCurrentDefaultPath());var n=this.__createElement("g");e.appendChild(n),this.__currentElement=n}var i=this.__currentElement.getAttribute("transform");i?i+=" ":i="",i+=t,this.__currentElement.setAttribute("transform",i)},r.prototype.scale=function(t,e){void 0===e&&(e=t),this.__addTransform(l("scale({x},{y})",{x:t,y:e}))},r.prototype.rotate=function(t){var e=180*t/Math.PI;this.__addTransform(l("rotate({angle},{cx},{cy})",{angle:e,cx:0,cy:0}))},r.prototype.translate=function(t,e){this.__addTransform(l("translate({x},{y})",{x:t,y:e}))},r.prototype.transform=function(t,e,n,i,r,s){this.__addTransform(l("matrix({a},{b},{c},{d},{e},{f})",{a:t,b:e,c:n,d:i,e:r,f:s}))},r.prototype.beginPath=function(){var t;this.__currentDefaultPath="",this.__currentPosition={},t=this.__createElement("path",{},!0),this.__closestGroupOrSvg().appendChild(t),this.__currentElement=t},r.prototype.__applyCurrentDefaultPath=function(){var t=this.__currentElement;"path"===t.nodeName?t.setAttribute("d",this.__currentDefaultPath):console.error("Attempted to apply path command to node",t.nodeName)},r.prototype.__addPathCommand=function(t){this.__currentDefaultPath+=" ",this.__currentDefaultPath+=t},r.prototype.moveTo=function(t,e){"path"!==this.__currentElement.nodeName&&this.beginPath(),this.__currentPosition={x:t,y:e},this.__addPathCommand(l("M {x} {y}",{x:t,y:e}))},r.prototype.closePath=function(){this.__currentDefaultPath&&this.__addPathCommand("Z")},r.prototype.lineTo=function(t,e){this.__currentPosition={x:t,y:e},this.__currentDefaultPath.indexOf("M")>-1?this.__addPathCommand(l("L {x} {y}",{x:t,y:e})):this.__addPathCommand(l("M {x} {y}",{x:t,y:e}))},r.prototype.bezierCurveTo=function(t,e,n,i,r,s){this.__currentPosition={x:r,y:s},this.__addPathCommand(l("C {cp1x} {cp1y} {cp2x} {cp2y} {x} {y}",{cp1x:t,cp1y:e,cp2x:n,cp2y:i,x:r,y:s}))},r.prototype.quadraticCurveTo=function(t,e,n,i){this.__currentPosition={x:n,y:i},this.__addPathCommand(l("Q {cpx} {cpy} {x} {y}",{cpx:t,cpy:e,x:n,y:i}))};var u=function(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]);return[t[0]/e,t[1]/e]};function d(t,e){const n=t.width,i=t.height,s=document.createElement("div"),o=document.createElement("button");o.innerText="Make SVG",o.onclick=function(){const n=t.ctx;t.setCtx(c),t.setNoBuffers(!0),e(),function(){const t=c.getSerializedSvg(!0);h.innerHTML=t,h.hidden=!1,l.hidden=!1,a.hidden=!1;const e=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(t)}`;a.href=e}(),t.setCtx(n),t.setNoBuffers(!1)},s.appendChild(o);const a=document.createElement("a");a.innerText="Download SVG",a.download="vote.svg",a.hidden=!0,s.appendChild(a);const l=document.createElement("button");l.innerText="Hide SVG",l.hidden=!0,l.onclick=function(){h.hidden=!0,l.hidden=!0,a.hidden=!0},s.appendChild(l);const h=document.createElement("div");h.setAttribute("class","svgDiv"),h.style.width=`${n}px`,h.style.height=`${i}px`,h.hidden=!0,s.appendChild(h);const c=new r(n,i);return s}function f(t,e){const n=this;n.config=t,n.name=t.name,n.nameIsHTML=t.nameIsHTML||!1,n.dom=document.createElement("div"),n.dom.setAttribute("class","button");let i=t.margin;i=i||0,i=Math.max(i,4),n.dom.style.marginRight=`${i}px`,n.draw=function(){n.nameIsHTML?n.dom.innerHTML=n.name:n.dom.innerText=n.name},n.draw(),n.dom.setAttribute("title",t.realname||""),n.onClick=function(){e(n,t)},n.dom.onclick=n.onClick,n.turnOff=function(){n.isOn=!1,n.config.isOn=!1,n.dom.setAttribute("on","no")},n.turnOn=function(){n.isOn=!0,n.config.isOn=!0,n.dom.setAttribute("on","yes")},n.turnOff()}function p(t){const e=this;e.config=t,void 0===t.data&&(t.data=[],void 0===t.makeData&&(t.makeData=()=>[]),e.makeData=t.makeData,e.buttonConfigs=e.makeData(),e.doMakeData=!0),e.buttonConfigs=t.data,e.labelName=t.label,e.labelIsHTML=t.labelIsHTML||!1,e.onChoose=t.onChoose,e.isCheckbox=t.isCheckbox||!1,e.isCheckboxBool=t.isCheckboxBool||!1,e.justButton=t.justButton||!1,e.buttonHidden=t.buttonHidden||{},e.dom=document.createElement("div"),e.dom.setAttribute("class","button-group"),e.buttonDOMByValue=[],e.init=function(){e.doMakeData&&(e.buttonConfigs=e.makeData()),e.dom.innerHTML="",e.buttons=[],e.buttonsByName={},e.labelDOM=document.createElement("div"),e.labelDOM.setAttribute("class","button-group-label"),e.draw(),e.dom.appendChild(e.labelDOM);for(let n=0;n<e.buttonConfigs.length;n++){const i=e.buttonConfigs[n],r=new f(i,e.onToggle);e.buttonsByName[i.name]=r,r.dom.style.width=`${t.width}px`,i.width&&(r.dom.style.width=`${i.width}px`),e.buttons.push(r),e.dom.appendChild(r.dom),e.buttonDOMByValue[i.value]=r.dom}for(let t=0;t<e.buttons.length;t++){const n=e.buttons[t];if(n.config.selected){n.turnOn();break}}e.draw()},e.updateNames=function(){const t=e.makeData();for(let n=0;n<e.buttonConfigs.length;n++)e.buttonConfigs[n].name=t[n].name,e.buttons[n].name=e.buttonConfigs[n].name},e.redraw=function(){e.updateNames(),e.draw()},e.draw=function(){e.labelIsHTML?e.labelDOM.innerHTML=e.labelName:e.labelDOM.innerText=e.labelName;for(const t of e.buttons)t.draw()},e.configureHidden=function(){for(const[t,n]of Object.entries(e.buttonHidden))e.buttonsByName[t].dom.hidden=n},e.onToggle=function(t,n){if(e.isCheckbox||e.isCheckboxBool)t.isOn?t.turnOff():t.turnOn();else{for(let t=0;t<e.buttons.length;t++)e.buttons[t].turnOff();t.turnOn(),e.justButton&&setTimeout((()=>t.turnOff()),800)}e.onChoose(n)},e.highlight=function(t,n){if(0!==e.buttons.length){for(let t=0;t<e.buttons.length;t++)e.buttons[t].turnOff();if(e.isCheckbox)for(const i in e.buttons){const r=e.buttons[i];n.includes(r.config[t])&&r.turnOn()}else if(e.isCheckboxBool)for(const i in e.buttons){const r=e.buttons[i],s=r.config[t];s in n&&n[s]&&r.turnOn()}else{const i=e.buttons.filter((e=>{const{config:i}=e;return i[t]===n}))[0];void 0!==i&&i.turnOn()}}},e.init()}function _(t,e,n,i,r,s,o){const a=this;var l;a.list=r,a.onChoose=function(t){n(t.value),a.configure(),o.add(s)},a.choose=new p({label:i,width:(l=2,(220-4*(l-1))/l-2),data:a.list,onChoose:a.onChoose}),a.configure=function(){},a.select=function(){a.choose.highlight("value",t[e])}}function g(t){const e=this;e.divMenu=document.createElement("div"),e.addMenuItem=function(n,i){const{prop:r,setProp:s,label:o,options:a,change:l}=i,h=new _(n,r,s,o,a,l,t);h.select(),e.divMenu.appendChild(h.choose.dom)}}function m(t){const e=function(t){const e=t.length,n=new Array(e);for(let i=0;i<e;i++){n[i]=[];for(let r=0;r<e;r++){if(i===r)continue;const e=t[i],s=t[r];n[i].push(y(e,s))}}return n}(t);this.sumArea=function(t){const n=e.length,i=Array(n);for(let r=0;r<n;r++){const n=e[r];i[r]=v(t,n)}return i}}function y(t,e){const n=e.x-t.x,i=e.y-t.y;return{A:{x:n,y:i},b:.5*(t.x+e.x)*n+.5*(t.y+e.y)*i}}function v(t,e){let n=0;const i=t.x,r=t.y,{r:s}=t;for(let t=i-s;t<i+s;t+=2){const o=s**2-(t-i)**2;let a;a=o>0?Math.sqrt(o):0;let l=r+a,h=r-a;e.forEach((e=>{const n=e.A.y,i=e.A.x,{b:r}=e;if(0===n)i*t<r||(h=1/0);else{const e=(r-i*t)/n;n<0?h=Math.max(h,e):l=Math.min(l,e)}}));const c=l-h;if(c>0){n+=2*c}}return n}r.prototype.arcTo=function(t,e,n,i,r){var s=this.__currentPosition&&this.__currentPosition.x,o=this.__currentPosition&&this.__currentPosition.y;if(void 0!==s&&void 0!==o){if(r<0)throw new Error("IndexSizeError: The radius provided ("+r+") is negative.");if(s===t&&o===e||t===n&&e===i||0===r)this.lineTo(t,e);else{var a=u([s-t,o-e]),l=u([n-t,i-e]);if(a[0]*l[1]!=a[1]*l[0]){var h=a[0]*l[0]+a[1]*l[1],c=Math.acos(Math.abs(h)),d=u([a[0]+l[0],a[1]+l[1]]),f=r/Math.sin(c/2),p=t+f*d[0],_=e+f*d[1],g=[-a[1],a[0]],m=[l[1],-l[0]],y=function(t){var e=t[0];return t[1]>=0?Math.acos(e):-Math.acos(e)},v=y(g),x=y(m);this.lineTo(p+g[0]*r,_+g[1]*r),this.arc(p,_,r,v,x)}else this.lineTo(t,e)}}},r.prototype.stroke=function(){"path"===this.__currentElement.nodeName&&this.__currentElement.setAttribute("paint-order","fill stroke markers"),this.__applyCurrentDefaultPath(),this.__applyStyleToCurrentElement("stroke")},r.prototype.fill=function(){"path"===this.__currentElement.nodeName&&this.__currentElement.setAttribute("paint-order","stroke fill markers"),this.__applyCurrentDefaultPath(),this.__applyStyleToCurrentElement("fill")},r.prototype.rect=function(t,e,n,i){"path"!==this.__currentElement.nodeName&&this.beginPath(),this.moveTo(t,e),this.lineTo(t+n,e),this.lineTo(t+n,e+i),this.lineTo(t,e+i),this.lineTo(t,e),this.closePath()},r.prototype.fillRect=function(t,e,n,i){var r;r=this.__createElement("rect",{x:t,y:e,width:n,height:i},!0),this.__closestGroupOrSvg().appendChild(r),this.__currentElement=r,this.__applyStyleToCurrentElement("fill")},r.prototype.strokeRect=function(t,e,n,i){var r;r=this.__createElement("rect",{x:t,y:e,width:n,height:i},!0),this.__closestGroupOrSvg().appendChild(r),this.__currentElement=r,this.__applyStyleToCurrentElement("stroke")},r.prototype.__clearCanvas=function(){for(var t=this.__closestGroupOrSvg().getAttribute("transform"),e=this.__root.childNodes[1],n=e.childNodes,i=n.length-1;i>=0;i--)n[i]&&e.removeChild(n[i]);this.__currentElement=e,this.__groupStack=[],t&&this.__addTransform(t)},r.prototype.clearRect=function(t,e,n,i){if(0!==t||0!==e||n!==this.width||i!==this.height){var r,s=this.__closestGroupOrSvg();r=this.__createElement("rect",{x:t,y:e,width:n,height:i,fill:"#FFFFFF"},!0),s.appendChild(r)}else this.__clearCanvas()},r.prototype.createLinearGradient=function(t,e,n,i){var r=this.__createElement("linearGradient",{id:h(this.__ids),x1:t+"px",x2:n+"px",y1:e+"px",y2:i+"px",gradientUnits:"userSpaceOnUse"},!1);return this.__defs.appendChild(r),new s(r,this)},r.prototype.createRadialGradient=function(t,e,n,i,r,o){var a=this.__createElement("radialGradient",{id:h(this.__ids),cx:i+"px",cy:r+"px",r:o+"px",fx:t+"px",fy:e+"px",gradientUnits:"userSpaceOnUse"},!1);return this.__defs.appendChild(a),new s(a,this)},r.prototype.__parseFont=function(){var t=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-,\'\"\sa-z0-9]+?)\s*$/i.exec(this.font),e={style:t[1]||"normal",size:t[4]||"10px",family:t[6]||"sans-serif",weight:t[3]||"normal",decoration:t[2]||"normal",href:null};return"underline"===this.__fontUnderline&&(e.decoration="underline"),this.__fontHref&&(e.href=this.__fontHref),e},r.prototype.__wrapTextLink=function(t,e){if(t.href){var n=this.__createElement("a");return n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",t.href),n.appendChild(e),n}return e},r.prototype.__applyText=function(t,e,n,i){var r,s,o=this.__parseFont(),a=this.__closestGroupOrSvg(),l=this.__createElement("text",{"font-family":o.family,"font-size":o.size,"font-style":o.style,"font-weight":o.weight,"text-decoration":o.decoration,x:e,y:n,"text-anchor":(r=this.textAlign,s={left:"start",right:"end",center:"middle",start:"start",end:"end"},s[r]||s.start),"dominant-baseline":c(this.textBaseline)},!0);l.appendChild(this.__document.createTextNode(t)),this.__currentElement=l,this.__applyStyleToCurrentElement(i),a.appendChild(this.__wrapTextLink(o,l))},r.prototype.fillText=function(t,e,n){this.__applyText(t,e,n,"fill")},r.prototype.strokeText=function(t,e,n){this.__applyText(t,e,n,"stroke")},r.prototype.measureText=function(t){return this.__ctx.font=this.font,this.__ctx.measureText(t)},r.prototype.arc=function(t,e,n,i,r,s){if(i!==r){(i%=2*Math.PI)===(r%=2*Math.PI)&&(r=(r+2*Math.PI-.001*(s?-1:1))%(2*Math.PI));var o=t+n*Math.cos(r),a=e+n*Math.sin(r),h=t+n*Math.cos(i),c=e+n*Math.sin(i),u=s?0:1,d=0,f=r-i;f<0&&(f+=2*Math.PI),d=s?f>Math.PI?0:1:f>Math.PI?1:0,this.lineTo(h,c),this.__addPathCommand(l("A {rx} {ry} {xAxisRotation} {largeArcFlag} {sweepFlag} {endX} {endY}",{rx:n,ry:n,xAxisRotation:0,largeArcFlag:d,sweepFlag:u,endX:o,endY:a})),this.__currentPosition={x:o,y:a}}},r.prototype.clip=function(){var t=this.__closestGroupOrSvg(),e=this.__createElement("clipPath"),n=h(this.__ids),i=this.__createElement("g");this.__applyCurrentDefaultPath(),t.removeChild(this.__currentElement),e.setAttribute("id",n),e.appendChild(this.__currentElement),this.__defs.appendChild(e),t.setAttribute("clip-path",l("url(#{id})",{id:n})),t.appendChild(i),this.__currentElement=i},r.prototype.drawImage=function(){var t,e,n,i,s,o,a,l,h,c,u,d,f,p=Array.prototype.slice.call(arguments),_=p[0],g=0,m=0;if(3===p.length)t=p[1],e=p[2],n=s=_.width,i=o=_.height;else if(5===p.length)t=p[1],e=p[2],n=p[3],i=p[4],s=_.width,o=_.height;else{if(9!==p.length)throw new Error("Invalid number of arguments passed to drawImage: "+arguments.length);g=p[1],m=p[2],s=p[3],o=p[4],t=p[5],e=p[6],n=p[7],i=p[8]}a=this.__closestGroupOrSvg(),this.__currentElement;var y="translate("+t+", "+e+")";if(_ instanceof r){if((l=_.getSvg().cloneNode(!0)).childNodes&&l.childNodes.length>1){for(h=l.childNodes[0];h.childNodes.length;)f=h.childNodes[0].getAttribute("id"),this.__ids[f]=f,this.__defs.appendChild(h.childNodes[0]);if(c=l.childNodes[1]){var v,x=c.getAttribute("transform");v=x?x+" "+y:y,c.setAttribute("transform",v),a.appendChild(c)}}}else"CANVAS"!==_.nodeName&&"IMG"!==_.nodeName||((u=this.__createElement("image")).setAttribute("width",n),u.setAttribute("height",i),u.setAttribute("preserveAspectRatio","none"),(g||m||s!==_.width||o!==_.height)&&((d=this.__document.createElement("canvas")).width=n,d.height=i,d.getContext("2d").drawImage(_,g,m,s,o,0,0,n,i),_=d),u.setAttribute("transform",y),u.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","CANVAS"===_.nodeName?_.toDataURL():_.getAttribute("src")),a.appendChild(u))},r.prototype.createPattern=function(t,e){var n,i=this.__document.createElementNS("http://www.w3.org/2000/svg","pattern"),s=h(this.__ids);return i.setAttribute("id",s),i.setAttribute("width",t.width),i.setAttribute("height",t.height),"CANVAS"===t.nodeName||"IMG"===t.nodeName?((n=this.__document.createElementNS("http://www.w3.org/2000/svg","image")).setAttribute("width",t.width),n.setAttribute("height",t.height),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","CANVAS"===t.nodeName?t.toDataURL():t.getAttribute("src")),i.appendChild(n),this.__defs.appendChild(i)):t instanceof r&&(i.appendChild(t.__root.childNodes[1]),this.__defs.appendChild(i)),new o(i,this)},r.prototype.setLineDash=function(t){t&&t.length>0?this.lineDash=t.join(","):this.lineDash=null},r.prototype.drawFocusRing=function(){},r.prototype.createImageData=function(){},r.prototype.getImageData=function(){},r.prototype.putImageData=function(){},r.prototype.globalCompositeOperation=function(){},r.prototype.setTransform=function(){};var x={pluralityBallot:function(t,e){const n=new m(t),i=t.length;let r=new Array(i).fill(0);e.forEach((t=>{const e=n.sumArea(t);r=r.map(((t,n)=>t+e[n]))}));const s=r.reduce(((t,e)=>t+e));return{tallyFractions:r.map((t=>t/s))}}};const w={plurality:function(t){const e=Math.max(...t.tallyFractions);return{iWinner:t.tallyFractions.indexOf(e)}},randomWinner:function(t){const e=t.tallyFractions.length;return{iWinner:Math.floor(Math.random()*e)}},huntingtonHill:function(t,e){const{seats:n,threshold:i}=e,r=t.tallyFractions.map((t=>t<i?0:t)),s=r.length;if(0===i&&s>n){const e=[...r].sort(((t,e)=>e-t))[n-1];return t.tallyFractions.map((t=>t>=e))}const o=Array(s).fill().map(((t,e)=>Math.sqrt(e*(e+1)))),a=r.map((t=>0===t?[]:o.map((e=>e/t)))).flat().flat().sort(((t,e)=>t-e))[n-1];return{allocation:r.map((t=>.5*(-1+Math.sqrt(1+4*(t*a)**2)))).map((t=>Math.floor(t)+1))}}};var b=w;function A(t,e){const n=this;n.run=e=>{let i;if("allocation"===n.checkElectionType()){const r={seats:5,threshold:.2},s=b[n.electionMethod](e,r),{allocation:o}=s;i={allocation:o,candidates:t}}else{const r=b[n.electionMethod](e),{iWinner:s}=r;i={iWinner:s,winner:t[s]}}return i},n.electionMethodList=[{name:"Huntington Hill",value:"huntingtonHill",type:"allocation"},{name:"Plurality",value:"plurality",type:"singleWinner"},{name:"Random Winner",value:"randomWinner",type:"singleWinner"}],n.checkElectionType=()=>n.electionMethodListByFunctionName[n.electionMethod].type,n.electionMethodListByFunctionName=[],n.electionMethodList.forEach((t=>{n.electionMethodListByFunctionName[t.value]=t})),n.electionMethod="plurality",e.addMenuItem(n,{label:"Election Method:",prop:"electionMethod",setProp:t=>{n.electionMethod=t},options:n.electionMethodList,change:["electionMethod"]})}function k(t){const e=this,n=[],i=[];e.method=new A(i,t),e.newVoterGroup=function(t){n.push(t)},e.newCandidate=function(t){i.push(t)},e.clearCandidates=function(){i.splice(0,i.length)},e.clear=()=>{i.splice(0,i.length),n.splice(0,n.length)},e.getCandidates=function(){return i},e.runElection=function(){const t=x.pluralityBallot(i,n);return e.method.run(t)},e.updateTallies=function(){const t=x.pluralityBallot(i,n);i.forEach(((e,n)=>{const i=t.tallyFractions[n];e.setFraction(i)}))}}var S,M,C={},T=C={};function E(){throw new Error("setTimeout has not been defined")}function P(){throw new Error("clearTimeout has not been defined")}function I(t){if(S===setTimeout)return setTimeout(t,0);if((S===E||!S)&&setTimeout)return S=setTimeout,setTimeout(t,0);try{return S(t,0)}catch(e){try{return S.call(null,t,0)}catch(e){return S.call(this,t,0)}}}!function(){try{S="function"==typeof setTimeout?setTimeout:E}catch(t){S=E}try{M="function"==typeof clearTimeout?clearTimeout:P}catch(t){M=P}}();var O,N=[],R=!1,D=-1;function F(){R&&O&&(R=!1,O.length?N=O.concat(N):D=-1,N.length&&j())}function j(){if(!R){var t=I(F);R=!0;for(var e=N.length;e;){for(O=N,N=[];++D<e;)O&&O[D].run();D=-1,e=N.length}O=null,R=!1,function(t){if(M===clearTimeout)return clearTimeout(t);if((M===P||!M)&&clearTimeout)return M=clearTimeout,clearTimeout(t);try{M(t)}catch(e){try{return M.call(null,t)}catch(e){return M.call(this,t)}}}(t)}}function q(t,e){this.fun=t,this.array=e}function L(){}T.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];N.push(new q(t,e)),1!==N.length||R||I(j)},q.prototype.run=function(){this.fun.apply(null,this.array)},T.title="browser",T.browser=!0,T.env={},T.argv=[],T.version="",T.versions={},T.on=L,T.addListener=L,T.once=L,T.off=L,T.removeListener=L,T.removeAllListeners=L,T.emit=L,T.prependListener=L,T.prependOnceListener=L,T.listeners=function(t){return[]},T.binding=function(t){throw new Error("process.binding is not supported")},T.cwd=function(){return"/"},T.chdir=function(t){throw new Error("process.chdir is not supported")},T.umask=function(){return 0};var B,U={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){return 0===t?0:1===t?1:-Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)},Out:function(t){return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin(5*(t-.1)*Math.PI)+1},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?-.5*Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)+1}},Back:{In:function(t){var e=1.70158;return t*t*((e+1)*t-e)},Out:function(t){var e=1.70158;return--t*t*((e+1)*t+e)+1},InOut:function(t){var e=2.5949095;return(t*=2)<1?t*t*((e+1)*t-e)*.5:.5*((t-=2)*t*((e+1)*t+e)+2)}},Bounce:{In:function(t){return 1-U.Bounce.Out(1-t)},Out:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return t<.5?.5*U.Bounce.In(2*t):.5*U.Bounce.Out(2*t-1)+.5}}},H="undefined"==typeof self&&void 0!==C&&C.hrtime?function(){var t=C.hrtime();return 1e3*t[0]+t[1]/1e6}:"undefined"!=typeof self&&void 0!==self.performance&&void 0!==self.performance.now?self.performance.now.bind(self.performance):void 0!==Date.now?Date.now:function(){return(new Date).getTime()},z=function(){function t(){this._tweens={},this._tweensAddedDuringUpdate={}}return t.prototype.getAll=function(){var t=this;return Object.keys(this._tweens).map((function(e){return t._tweens[e]}))},t.prototype.removeAll=function(){this._tweens={}},t.prototype.add=function(t){this._tweens[t.getId()]=t,this._tweensAddedDuringUpdate[t.getId()]=t},t.prototype.remove=function(t){delete this._tweens[t.getId()],delete this._tweensAddedDuringUpdate[t.getId()]},t.prototype.update=function(t,e){void 0===t&&(t=H()),void 0===e&&(e=!1);var n=Object.keys(this._tweens);if(0===n.length)return!1;for(;n.length>0;){this._tweensAddedDuringUpdate={};for(var i=0;i<n.length;i++){var r=this._tweens[n[i]],s=!e;r&&!1===r.update(t,s)&&!e&&delete this._tweens[n[i]]}n=Object.keys(this._tweensAddedDuringUpdate)}return!0},t}(),$={Linear:function(t,e){var n=t.length-1,i=n*e,r=Math.floor(i),s=$.Utils.Linear;return e<0?s(t[0],t[1],i):e>1?s(t[n],t[n-1],n-i):s(t[r],t[r+1>n?n:r+1],i-r)},Bezier:function(t,e){for(var n=0,i=t.length-1,r=Math.pow,s=$.Utils.Bernstein,o=0;o<=i;o++)n+=r(1-e,i-o)*r(e,o)*t[o]*s(i,o);return n},CatmullRom:function(t,e){var n=t.length-1,i=n*e,r=Math.floor(i),s=$.Utils.CatmullRom;return t[0]===t[n]?(e<0&&(r=Math.floor(i=n*(1+e))),s(t[(r-1+n)%n],t[r],t[(r+1)%n],t[(r+2)%n],i-r)):e<0?t[0]-(s(t[0],t[0],t[1],t[1],-i)-t[0]):e>1?t[n]-(s(t[n],t[n],t[n-1],t[n-1],i-n)-t[n]):s(t[r?r-1:0],t[r],t[n<r+1?n:r+1],t[n<r+2?n:r+2],i-r)},Utils:{Linear:function(t,e,n){return(e-t)*n+t},Bernstein:function(t,e){var n=$.Utils.Factorial;return n(t)/n(e)/n(t-e)},Factorial:(B=[1],function(t){var e=1;if(B[t])return B[t];for(var n=t;n>1;n--)e*=n;return B[t]=e,e}),CatmullRom:function(t,e,n,i,r){var s=.5*(n-t),o=.5*(i-e),a=r*r;return(2*e-2*n+s+o)*(r*a)+(-3*e+3*n-2*s-o)*a+s*r+e}}},G=function(){function t(){}return t.nextId=function(){return t._nextId++},t._nextId=0,t}(),V=new z,W=function(){function t(t,e){void 0===e&&(e=V),this._object=t,this._group=e,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=U.Linear.None,this._interpolationFunction=$.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._id=G.nextId(),this._isChainStopped=!1,this._goToEnd=!1}return t.prototype.getId=function(){return this._id},t.prototype.isPlaying=function(){return this._isPlaying},t.prototype.isPaused=function(){return this._isPaused},t.prototype.to=function(t,e){return this._valuesEnd=Object.create(t),void 0!==e&&(this._duration=e),this},t.prototype.duration=function(t){return this._duration=t,this},t.prototype.start=function(t){if(this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed)for(var e in this._reversed=!1,this._valuesStartRepeat)this._swapEndStartRepeatValues(e),this._valuesStart[e]=this._valuesStartRepeat[e];return this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=void 0!==t?"string"==typeof t?H()+parseFloat(t):t:H(),this._startTime+=this._delayTime,this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat),this},t.prototype._setupProperties=function(t,e,n,i){for(var r in n){var s=t[r],o=Array.isArray(s),a=o?"array":typeof s,l=!o&&Array.isArray(n[r]);if("undefined"!==a&&"function"!==a){if(l){var h=n[r];if(0===h.length)continue;h=h.map(this._handleRelativeValue.bind(this,s)),n[r]=[s].concat(h)}if("object"!==a&&!o||!s||l)void 0===e[r]&&(e[r]=s),o||(e[r]*=1),i[r]=l?n[r].slice().reverse():e[r]||0;else{for(var c in e[r]=o?[]:{},s)e[r][c]=s[c];i[r]=o?[]:{},this._setupProperties(s,e[r],n[r],i[r])}}}},t.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},t.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},t.prototype.pause=function(t){return void 0===t&&(t=H()),this._isPaused||!this._isPlaying||(this._isPaused=!0,this._pauseStart=t,this._group&&this._group.remove(this)),this},t.prototype.resume=function(t){return void 0===t&&(t=H()),this._isPaused&&this._isPlaying?(this._isPaused=!1,this._startTime+=t-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this):this},t.prototype.stopChainedTweens=function(){for(var t=0,e=this._chainedTweens.length;t<e;t++)this._chainedTweens[t].stop();return this},t.prototype.group=function(t){return this._group=t,this},t.prototype.delay=function(t){return this._delayTime=t,this},t.prototype.repeat=function(t){return this._initialRepeat=t,this._repeat=t,this},t.prototype.repeatDelay=function(t){return this._repeatDelayTime=t,this},t.prototype.yoyo=function(t){return this._yoyo=t,this},t.prototype.easing=function(t){return this._easingFunction=t,this},t.prototype.interpolation=function(t){return this._interpolationFunction=t,this},t.prototype.chain=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this._chainedTweens=t,this},t.prototype.onStart=function(t){return this._onStartCallback=t,this},t.prototype.onUpdate=function(t){return this._onUpdateCallback=t,this},t.prototype.onRepeat=function(t){return this._onRepeatCallback=t,this},t.prototype.onComplete=function(t){return this._onCompleteCallback=t,this},t.prototype.onStop=function(t){return this._onStopCallback=t,this},t.prototype.update=function(t,e){if(void 0===t&&(t=H()),void 0===e&&(e=!0),this._isPaused)return!0;var n,i,r=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(t>r)return!1;e&&this.start(t)}if(this._goToEnd=!1,t<this._startTime)return!0;!1===this._onStartCallbackFired&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),i=(t-this._startTime)/this._duration,i=0===this._duration||i>1?1:i;var s=this._easingFunction(i);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,s),this._onUpdateCallback&&this._onUpdateCallback(this._object,i),1===i){if(this._repeat>0){for(n in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat)this._yoyo||"string"!=typeof this._valuesEnd[n]||(this._valuesStartRepeat[n]=this._valuesStartRepeat[n]+parseFloat(this._valuesEnd[n])),this._yoyo&&this._swapEndStartRepeatValues(n),this._valuesStart[n]=this._valuesStartRepeat[n];return this._yoyo&&(this._reversed=!this._reversed),void 0!==this._repeatDelayTime?this._startTime=t+this._repeatDelayTime:this._startTime=t+this._delayTime,this._onRepeatCallback&&this._onRepeatCallback(this._object),!0}this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var o=0,a=this._chainedTweens.length;o<a;o++)this._chainedTweens[o].start(this._startTime+this._duration);return this._isPlaying=!1,!1}return!0},t.prototype._updateProperties=function(t,e,n,i){for(var r in n)if(void 0!==e[r]){var s=e[r]||0,o=n[r],a=Array.isArray(t[r]),l=Array.isArray(o);!a&&l?t[r]=this._interpolationFunction(o,i):"object"==typeof o&&o?this._updateProperties(t[r],s,o,i):"number"==typeof(o=this._handleRelativeValue(s,o))&&(t[r]=s+(o-s)*i)}},t.prototype._handleRelativeValue=function(t,e){return"string"!=typeof e?e:"+"===e.charAt(0)||"-"===e.charAt(0)?t+parseFloat(e):parseFloat(e)},t.prototype._swapEndStartRepeatValues=function(t){var e=this._valuesStartRepeat[t],n=this._valuesEnd[t];this._valuesStartRepeat[t]="string"==typeof n?this._valuesStartRepeat[t]+parseFloat(n):this._valuesEnd[t],this._valuesEnd[t]=e},t}(),X=(G.nextId,V);X.getAll.bind(X),X.removeAll.bind(X),X.add.bind(X),X.remove.bind(X),X.update.bind(X);function Y(t,e,n,i){const r=this;r.r=e,r.trueR=e,r.pickUp=function(){r.tween=new W(r),r.tween.to({r:2*r.trueR},100),r.tween.start()},r.drop=function(){r.tween=new W(r),r.tween.to({r:r.trueR},100),r.tween.start()},r.render=function(){const{ctx:e}=i;r.tween&&r.tween.update(),e.beginPath(),e.fillStyle=n,e.arc(t.x,t.y,r.r,0,2*Math.PI),e.fill(),e.stroke()}}function K(t,e,n,i,r){let s,o,a,l,h=e[0],c=i[0],u=0,d=0;c>h==c>-h?(s=h,h=e[++u]):(s=c,c=i[++d]);let f=0;if(u<t&&d<n)for(c>h==c>-h?(o=h+s,a=s-(o-h),h=e[++u]):(o=c+s,a=s-(o-c),c=i[++d]),s=o,0!==a&&(r[f++]=a);u<t&&d<n;)c>h==c>-h?(o=s+h,l=o-s,a=s-(o-l)+(h-l),h=e[++u]):(o=s+c,l=o-s,a=s-(o-l)+(c-l),c=i[++d]),s=o,0!==a&&(r[f++]=a);for(;u<t;)o=s+h,l=o-s,a=s-(o-l)+(h-l),h=e[++u],s=o,0!==a&&(r[f++]=a);for(;d<n;)o=s+c,l=o-s,a=s-(o-l)+(c-l),c=i[++d],s=o,0!==a&&(r[f++]=a);return 0===s&&0!==f||(r[f++]=s),f}function Q(t){return new Float64Array(t)}const Z=Q(4),J=Q(8),tt=Q(12),et=Q(16),nt=Q(4);function it(t,e,n,i,r,s){const o=(e-s)*(n-r),a=(t-r)*(i-s),l=o-a;if(0===o||0===a||o>0!=a>0)return l;const h=Math.abs(o+a);return Math.abs(l)>=33306690738754716e-32*h?l:-function(t,e,n,i,r,s,o){let a,l,h,c,u,d,f,p,_,g,m,y,v,x,w,b,A,k;const S=t-r,M=n-r,C=e-s,T=i-s;x=S*T,d=134217729*S,f=d-(d-S),p=S-f,d=134217729*T,_=d-(d-T),g=T-_,w=p*g-(x-f*_-p*_-f*g),b=C*M,d=134217729*C,f=d-(d-C),p=C-f,d=134217729*M,_=d-(d-M),g=M-_,A=p*g-(b-f*_-p*_-f*g),m=w-A,u=w-m,Z[0]=w-(m+u)+(u-A),y=x+m,u=y-x,v=x-(y-u)+(m-u),m=v-b,u=v-m,Z[1]=v-(m+u)+(u-b),k=y+m,u=k-y,Z[2]=y-(k-u)+(m-u),Z[3]=k;let E=function(t,e){let n=e[0];for(let i=1;i<t;i++)n+=e[i];return n}(4,Z),P=22204460492503146e-32*o;if(E>=P||-E>=P)return E;if(u=t-S,a=t-(S+u)+(u-r),u=n-M,h=n-(M+u)+(u-r),u=e-C,l=e-(C+u)+(u-s),u=i-T,c=i-(T+u)+(u-s),0===a&&0===l&&0===h&&0===c)return E;if(P=11093356479670487e-47*o+33306690738754706e-32*Math.abs(E),E+=S*c+T*a-(C*h+M*l),E>=P||-E>=P)return E;x=a*T,d=134217729*a,f=d-(d-a),p=a-f,d=134217729*T,_=d-(d-T),g=T-_,w=p*g-(x-f*_-p*_-f*g),b=l*M,d=134217729*l,f=d-(d-l),p=l-f,d=134217729*M,_=d-(d-M),g=M-_,A=p*g-(b-f*_-p*_-f*g),m=w-A,u=w-m,nt[0]=w-(m+u)+(u-A),y=x+m,u=y-x,v=x-(y-u)+(m-u),m=v-b,u=v-m,nt[1]=v-(m+u)+(u-b),k=y+m,u=k-y,nt[2]=y-(k-u)+(m-u),nt[3]=k;const I=K(4,Z,4,nt,J);x=S*c,d=134217729*S,f=d-(d-S),p=S-f,d=134217729*c,_=d-(d-c),g=c-_,w=p*g-(x-f*_-p*_-f*g),b=C*h,d=134217729*C,f=d-(d-C),p=C-f,d=134217729*h,_=d-(d-h),g=h-_,A=p*g-(b-f*_-p*_-f*g),m=w-A,u=w-m,nt[0]=w-(m+u)+(u-A),y=x+m,u=y-x,v=x-(y-u)+(m-u),m=v-b,u=v-m,nt[1]=v-(m+u)+(u-b),k=y+m,u=k-y,nt[2]=y-(k-u)+(m-u),nt[3]=k;const O=K(I,J,4,nt,tt);x=a*c,d=134217729*a,f=d-(d-a),p=a-f,d=134217729*c,_=d-(d-c),g=c-_,w=p*g-(x-f*_-p*_-f*g),b=l*h,d=134217729*l,f=d-(d-l),p=l-f,d=134217729*h,_=d-(d-h),g=h-_,A=p*g-(b-f*_-p*_-f*g),m=w-A,u=w-m,nt[0]=w-(m+u)+(u-A),y=x+m,u=y-x,v=x-(y-u)+(m-u),m=v-b,u=v-m,nt[1]=v-(m+u)+(u-b),k=y+m,u=k-y,nt[2]=y-(k-u)+(m-u),nt[3]=k;const N=K(O,tt,4,nt,et);return et[N-1]}(t,e,n,i,r,s,h)}const rt=Math.pow(2,-52),st=new Uint32Array(512);class ot{static from(t,e=dt,n=ft){const i=t.length,r=new Float64Array(2*i);for(let s=0;s<i;s++){const i=t[s];r[2*s]=e(i),r[2*s+1]=n(i)}return new ot(r)}constructor(t){const e=t.length>>1;if(e>0&&"number"!=typeof t[0])throw new Error("Expected coords to contain numbers.");this.coords=t;const n=Math.max(2*e-5,0);this._triangles=new Uint32Array(3*n),this._halfedges=new Int32Array(3*n),this._hashSize=Math.ceil(Math.sqrt(e)),this._hullPrev=new Uint32Array(e),this._hullNext=new Uint32Array(e),this._hullTri=new Uint32Array(e),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(e),this._dists=new Float64Array(e),this.update()}update(){const{coords:t,_hullPrev:e,_hullNext:n,_hullTri:i,_hullHash:r}=this,s=t.length>>1;let o=1/0,a=1/0,l=-1/0,h=-1/0;for(let e=0;e<s;e++){const n=t[2*e],i=t[2*e+1];n<o&&(o=n),i<a&&(a=i),n>l&&(l=n),i>h&&(h=i),this._ids[e]=e}const c=(o+l)/2,u=(a+h)/2;let d,f,p,_=1/0;for(let e=0;e<s;e++){const n=at(c,u,t[2*e],t[2*e+1]);n<_&&(d=e,_=n)}const g=t[2*d],m=t[2*d+1];_=1/0;for(let e=0;e<s;e++){if(e===d)continue;const n=at(g,m,t[2*e],t[2*e+1]);n<_&&n>0&&(f=e,_=n)}let y=t[2*f],v=t[2*f+1],x=1/0;for(let e=0;e<s;e++){if(e===d||e===f)continue;const n=ht(g,m,y,v,t[2*e],t[2*e+1]);n<x&&(p=e,x=n)}let w=t[2*p],b=t[2*p+1];if(x===1/0){for(let e=0;e<s;e++)this._dists[e]=t[2*e]-t[0]||t[2*e+1]-t[1];ct(this._ids,this._dists,0,s-1);const e=new Uint32Array(s);let n=0;for(let t=0,i=-1/0;t<s;t++){const r=this._ids[t];this._dists[r]>i&&(e[n++]=r,i=this._dists[r])}return this.hull=e.subarray(0,n),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(it(g,m,y,v,w,b)<0){const t=f,e=y,n=v;f=p,y=w,v=b,p=t,w=e,b=n}const A=function(t,e,n,i,r,s){const o=n-t,a=i-e,l=r-t,h=s-e,c=o*o+a*a,u=l*l+h*h,d=.5/(o*h-a*l);return{x:t+(h*c-a*u)*d,y:e+(o*u-l*c)*d}}(g,m,y,v,w,b);this._cx=A.x,this._cy=A.y;for(let e=0;e<s;e++)this._dists[e]=at(t[2*e],t[2*e+1],A.x,A.y);ct(this._ids,this._dists,0,s-1),this._hullStart=d;let k=3;n[d]=e[p]=f,n[f]=e[d]=p,n[p]=e[f]=d,i[d]=0,i[f]=1,i[p]=2,r.fill(-1),r[this._hashKey(g,m)]=d,r[this._hashKey(y,v)]=f,r[this._hashKey(w,b)]=p,this.trianglesLen=0,this._addTriangle(d,f,p,-1,-1,-1);for(let s,o,a=0;a<this._ids.length;a++){const l=this._ids[a],h=t[2*l],c=t[2*l+1];if(a>0&&Math.abs(h-s)<=rt&&Math.abs(c-o)<=rt)continue;if(s=h,o=c,l===d||l===f||l===p)continue;let u=0;for(let t=0,e=this._hashKey(h,c);t<this._hashSize&&(u=r[(e+t)%this._hashSize],-1===u||u===n[u]);t++);u=e[u];let _,g=u;for(;_=n[g],it(h,c,t[2*g],t[2*g+1],t[2*_],t[2*_+1])>=0;)if(g=_,g===u){g=-1;break}if(-1===g)continue;let m=this._addTriangle(g,l,n[g],-1,-1,i[g]);i[l]=this._legalize(m+2),i[g]=m,k++;let y=n[g];for(;_=n[y],it(h,c,t[2*y],t[2*y+1],t[2*_],t[2*_+1])<0;)m=this._addTriangle(y,l,_,i[l],-1,i[y]),i[l]=this._legalize(m+2),n[y]=y,k--,y=_;if(g===u)for(;_=e[g],it(h,c,t[2*_],t[2*_+1],t[2*g],t[2*g+1])<0;)m=this._addTriangle(_,l,g,-1,i[g],i[_]),this._legalize(m+2),i[_]=m,n[g]=g,k--,g=_;this._hullStart=e[l]=g,n[g]=e[y]=l,n[l]=y,r[this._hashKey(h,c)]=l,r[this._hashKey(t[2*g],t[2*g+1])]=g}this.hull=new Uint32Array(k);for(let t=0,e=this._hullStart;t<k;t++)this.hull[t]=e,e=n[e];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,e){return Math.floor(function(t,e){const n=t/(Math.abs(t)+Math.abs(e));return(e>0?3-n:1+n)/4}(t-this._cx,e-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:e,_halfedges:n,coords:i}=this;let r=0,s=0;for(;;){const o=n[t],a=t-t%3;if(s=a+(t+2)%3,-1===o){if(0===r)break;t=st[--r];continue}const l=o-o%3,h=a+(t+1)%3,c=l+(o+2)%3,u=e[s],d=e[t],f=e[h],p=e[c];if(lt(i[2*u],i[2*u+1],i[2*d],i[2*d+1],i[2*f],i[2*f+1],i[2*p],i[2*p+1])){e[t]=p,e[o]=u;const i=n[c];if(-1===i){let e=this._hullStart;do{if(this._hullTri[e]===c){this._hullTri[e]=t;break}e=this._hullPrev[e]}while(e!==this._hullStart)}this._link(t,i),this._link(o,n[s]),this._link(s,c);const a=l+(o+1)%3;r<st.length&&(st[r++]=a)}else{if(0===r)break;t=st[--r]}}return s}_link(t,e){this._halfedges[t]=e,-1!==e&&(this._halfedges[e]=t)}_addTriangle(t,e,n,i,r,s){const o=this.trianglesLen;return this._triangles[o]=t,this._triangles[o+1]=e,this._triangles[o+2]=n,this._link(o,i),this._link(o+1,r),this._link(o+2,s),this.trianglesLen+=3,o}}function at(t,e,n,i){const r=t-n,s=e-i;return r*r+s*s}function lt(t,e,n,i,r,s,o,a){const l=t-o,h=e-a,c=n-o,u=i-a,d=r-o,f=s-a,p=c*c+u*u,_=d*d+f*f;return l*(u*_-p*f)-h*(c*_-p*d)+(l*l+h*h)*(c*f-u*d)<0}function ht(t,e,n,i,r,s){const o=n-t,a=i-e,l=r-t,h=s-e,c=o*o+a*a,u=l*l+h*h,d=.5/(o*h-a*l),f=(h*c-a*u)*d,p=(o*u-l*c)*d;return f*f+p*p}function ct(t,e,n,i){if(i-n<=20)for(let r=n+1;r<=i;r++){const i=t[r],s=e[i];let o=r-1;for(;o>=n&&e[t[o]]>s;)t[o+1]=t[o--];t[o+1]=i}else{let r=n+1,s=i;ut(t,n+i>>1,r),e[t[n]]>e[t[i]]&&ut(t,n,i),e[t[r]]>e[t[i]]&&ut(t,r,i),e[t[n]]>e[t[r]]&&ut(t,n,r);const o=t[r],a=e[o];for(;;){do{r++}while(e[t[r]]<a);do{s--}while(e[t[s]]>a);if(s<r)break;ut(t,r,s)}t[n+1]=t[s],t[s]=o,i-r+1>=s-n?(ct(t,e,r,i),ct(t,e,n,s-1)):(ct(t,e,n,s-1),ct(t,e,r,i))}}function ut(t,e,n){const i=t[e];t[e]=t[n],t[n]=i}function dt(t){return t[0]}function ft(t){return t[1]}class pt{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,e){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,e){this._+=`L${this._x1=+t},${this._y1=+e}`}arc(t,e,n){const i=(t=+t)+(n=+n),r=e=+e;if(n<0)throw new Error("negative radius");null===this._x1?this._+=`M${i},${r}`:(Math.abs(this._x1-i)>1e-6||Math.abs(this._y1-r)>1e-6)&&(this._+="L"+i+","+r),n&&(this._+=`A${n},${n},0,1,1,${t-n},${e}A${n},${n},0,1,1,${this._x1=i},${this._y1=r}`)}rect(t,e,n,i){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}h${+n}v${+i}h${-n}Z`}value(){return this._||null}}class _t{constructor(){this._=[]}moveTo(t,e){this._.push([t,e])}closePath(){this._.push(this._[0].slice())}lineTo(t,e){this._.push([t,e])}value(){return this._.length?this._:null}}class gt{constructor(t,[e,n,i,r]=[0,0,960,500]){if(!((i=+i)>=(e=+e)&&(r=+r)>=(n=+n)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(2*t.points.length),this.vectors=new Float64Array(2*t.points.length),this.xmax=i,this.xmin=e,this.ymax=r,this.ymin=n,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:e,triangles:n},vectors:i}=this,r=this.circumcenters=this._circumcenters.subarray(0,n.length/3*2);for(let e,i,s=0,o=0,a=n.length;s<a;s+=3,o+=2){const a=2*n[s],l=2*n[s+1],h=2*n[s+2],c=t[a],u=t[a+1],d=t[l],f=t[l+1],p=t[h],_=t[h+1],g=d-c,m=f-u,y=p-c,v=_-u,x=2*(g*v-m*y);if(Math.abs(x)<1e-9){let r=1e9;const s=2*n[0];r*=Math.sign((t[s]-c)*v-(t[s+1]-u)*y),e=(c+p)/2-r*v,i=(u+_)/2+r*y}else{const t=1/x,n=g*g+m*m,r=y*y+v*v;e=c+(v*n-m*r)*t,i=u+(g*r-y*n)*t}r[o]=e,r[o+1]=i}let s,o,a,l=e[e.length-1],h=4*l,c=t[2*l],u=t[2*l+1];i.fill(0);for(let n=0;n<e.length;++n)l=e[n],s=h,o=c,a=u,h=4*l,c=t[2*l],u=t[2*l+1],i[s+2]=i[h]=a-u,i[s+3]=i[h+1]=c-o}render(t){const e=null==t?t=new pt:void 0,{delaunay:{halfedges:n,inedges:i,hull:r},circumcenters:s,vectors:o}=this;if(r.length<=1)return null;for(let e=0,i=n.length;e<i;++e){const i=n[e];if(i<e)continue;const r=2*Math.floor(e/3),o=2*Math.floor(i/3),a=s[r],l=s[r+1],h=s[o],c=s[o+1];this._renderSegment(a,l,h,c,t)}let a,l=r[r.length-1];for(let e=0;e<r.length;++e){a=l,l=r[e];const n=2*Math.floor(i[l]/3),h=s[n],c=s[n+1],u=4*a,d=this._project(h,c,o[u+2],o[u+3]);d&&this._renderSegment(h,c,d[0],d[1],t)}return e&&e.value()}renderBounds(t){const e=null==t?t=new pt:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),e&&e.value()}renderCell(t,e){const n=null==e?e=new pt:void 0,i=this._clip(t);if(null===i||!i.length)return;e.moveTo(i[0],i[1]);let r=i.length;for(;i[0]===i[r-2]&&i[1]===i[r-1]&&r>1;)r-=2;for(let t=2;t<r;t+=2)i[t]===i[t-2]&&i[t+1]===i[t-1]||e.lineTo(i[t],i[t+1]);return e.closePath(),n&&n.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let e=0,n=t.length/2;e<n;++e){const t=this.cellPolygon(e);t&&(t.index=e,yield t)}}cellPolygon(t){const e=new _t;return this.renderCell(t,e),e.value()}_renderSegment(t,e,n,i,r){let s;const o=this._regioncode(t,e),a=this._regioncode(n,i);0===o&&0===a?(r.moveTo(t,e),r.lineTo(n,i)):(s=this._clipSegment(t,e,n,i,o,a))&&(r.moveTo(s[0],s[1]),r.lineTo(s[2],s[3]))}contains(t,e,n){return(e=+e)==e&&(n=+n)==n&&this.delaunay._step(t,e,n)===t}*neighbors(t){const e=this._clip(t);if(e)for(const n of this.delaunay.neighbors(t)){const t=this._clip(n);if(t)t:for(let i=0,r=e.length;i<r;i+=2)for(let s=0,o=t.length;s<o;s+=2)if(e[i]==t[s]&&e[i+1]==t[s+1]&&e[(i+2)%r]==t[(s+o-2)%o]&&e[(i+3)%r]==t[(s+o-1)%o]){yield n;break t}}}_cell(t){const{circumcenters:e,delaunay:{inedges:n,halfedges:i,triangles:r}}=this,s=n[t];if(-1===s)return null;const o=[];let a=s;do{const n=Math.floor(a/3);if(o.push(e[2*n],e[2*n+1]),a=a%3==2?a-2:a+1,r[a]!==t)break;a=i[a]}while(a!==s&&-1!==a);return o}_clip(t){if(0===t&&1===this.delaunay.hull.length)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const e=this._cell(t);if(null===e)return null;const{vectors:n}=this,i=4*t;return n[i]||n[i+1]?this._clipInfinite(t,e,n[i],n[i+1],n[i+2],n[i+3]):this._clipFinite(t,e)}_clipFinite(t,e){const n=e.length;let i,r,s,o,a=null,l=e[n-2],h=e[n-1],c=this._regioncode(l,h),u=0;for(let d=0;d<n;d+=2)if(i=l,r=h,l=e[d],h=e[d+1],s=c,c=this._regioncode(l,h),0===s&&0===c)o=u,u=0,a?a.push(l,h):a=[l,h];else{let e,n,d,f,p;if(0===s){if(null===(e=this._clipSegment(i,r,l,h,s,c)))continue;[n,d,f,p]=e}else{if(null===(e=this._clipSegment(l,h,i,r,c,s)))continue;[f,p,n,d]=e,o=u,u=this._edgecode(n,d),o&&u&&this._edge(t,o,u,a,a.length),a?a.push(n,d):a=[n,d]}o=u,u=this._edgecode(f,p),o&&u&&this._edge(t,o,u,a,a.length),a?a.push(f,p):a=[f,p]}if(a)o=u,u=this._edgecode(a[0],a[1]),o&&u&&this._edge(t,o,u,a,a.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return a}_clipSegment(t,e,n,i,r,s){for(;;){if(0===r&&0===s)return[t,e,n,i];if(r&s)return null;let o,a,l=r||s;8&l?(o=t+(n-t)*(this.ymax-e)/(i-e),a=this.ymax):4&l?(o=t+(n-t)*(this.ymin-e)/(i-e),a=this.ymin):2&l?(a=e+(i-e)*(this.xmax-t)/(n-t),o=this.xmax):(a=e+(i-e)*(this.xmin-t)/(n-t),o=this.xmin),r?(t=o,e=a,r=this._regioncode(t,e)):(n=o,i=a,s=this._regioncode(n,i))}}_clipInfinite(t,e,n,i,r,s){let o,a=Array.from(e);if((o=this._project(a[0],a[1],n,i))&&a.unshift(o[0],o[1]),(o=this._project(a[a.length-2],a[a.length-1],r,s))&&a.push(o[0],o[1]),a=this._clipFinite(t,a))for(let e,n=0,i=a.length,r=this._edgecode(a[i-2],a[i-1]);n<i;n+=2)e=r,r=this._edgecode(a[n],a[n+1]),e&&r&&(n=this._edge(t,e,r,a,n),i=a.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(a=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return a}_edge(t,e,n,i,r){for(;e!==n;){let n,s;switch(e){case 5:e=4;continue;case 4:e=6,n=this.xmax,s=this.ymin;break;case 6:e=2;continue;case 2:e=10,n=this.xmax,s=this.ymax;break;case 10:e=8;continue;case 8:e=9,n=this.xmin,s=this.ymax;break;case 9:e=1;continue;case 1:e=5,n=this.xmin,s=this.ymin}i[r]===n&&i[r+1]===s||!this.contains(t,n,s)||(i.splice(r,0,n,s),r+=2)}if(i.length>4)for(let t=0;t<i.length;t+=2){const e=(t+2)%i.length,n=(t+4)%i.length;(i[t]===i[e]&&i[e]===i[n]||i[t+1]===i[e+1]&&i[e+1]===i[n+1])&&(i.splice(e,2),t-=2)}return r}_project(t,e,n,i){let r,s,o,a=1/0;if(i<0){if(e<=this.ymin)return null;(r=(this.ymin-e)/i)<a&&(o=this.ymin,s=t+(a=r)*n)}else if(i>0){if(e>=this.ymax)return null;(r=(this.ymax-e)/i)<a&&(o=this.ymax,s=t+(a=r)*n)}if(n>0){if(t>=this.xmax)return null;(r=(this.xmax-t)/n)<a&&(s=this.xmax,o=e+(a=r)*i)}else if(n<0){if(t<=this.xmin)return null;(r=(this.xmin-t)/n)<a&&(s=this.xmin,o=e+(a=r)*i)}return[s,o]}_edgecode(t,e){return(t===this.xmin?1:t===this.xmax?2:0)|(e===this.ymin?4:e===this.ymax?8:0)}_regioncode(t,e){return(t<this.xmin?1:t>this.xmax?2:0)|(e<this.ymin?4:e>this.ymax?8:0)}}const mt=2*Math.PI,yt=Math.pow;function vt(t){return t[0]}function xt(t){return t[1]}function wt(t,e,n){return[t+Math.sin(t+e)*n,e+Math.cos(t-e)*n]}class bt{static from(t,e=vt,n=xt,i){return new bt("length"in t?function(t,e,n,i){const r=t.length,s=new Float64Array(2*r);for(let o=0;o<r;++o){const r=t[o];s[2*o]=e.call(i,r,o,t),s[2*o+1]=n.call(i,r,o,t)}return s}(t,e,n,i):Float64Array.from(function*(t,e,n,i){let r=0;for(const s of t)yield e.call(i,s,r,t),yield n.call(i,s,r,t),++r}(t,e,n,i)))}constructor(t){this._delaunator=new ot(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,e=this.points;if(t.hull&&t.hull.length>2&&function(t){const{triangles:e,coords:n}=t;for(let t=0;t<e.length;t+=3){const i=2*e[t],r=2*e[t+1],s=2*e[t+2];if((n[s]-n[i])*(n[r+1]-n[i+1])-(n[r]-n[i])*(n[s+1]-n[i+1])>1e-10)return!1}return!0}(t)){this.collinear=Int32Array.from({length:e.length/2},((t,e)=>e)).sort(((t,n)=>e[2*t]-e[2*n]||e[2*t+1]-e[2*n+1]));const t=this.collinear[0],n=this.collinear[this.collinear.length-1],i=[e[2*t],e[2*t+1],e[2*n],e[2*n+1]],r=1e-8*Math.hypot(i[3]-i[1],i[2]-i[0]);for(let t=0,n=e.length/2;t<n;++t){const n=wt(e[2*t],e[2*t+1],r);e[2*t]=n[0],e[2*t+1]=n[1]}this._delaunator=new ot(e)}else delete this.collinear;const n=this.halfedges=this._delaunator.halfedges,i=this.hull=this._delaunator.hull,r=this.triangles=this._delaunator.triangles,s=this.inedges.fill(-1),o=this._hullIndex.fill(-1);for(let t=0,e=n.length;t<e;++t){const e=r[t%3==2?t-2:t+1];-1!==n[t]&&-1!==s[e]||(s[e]=t)}for(let t=0,e=i.length;t<e;++t)o[i[t]]=t;i.length<=2&&i.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=i[0],s[i[0]]=1,2===i.length&&(s[i[1]]=0,this.triangles[1]=i[1],this.triangles[2]=i[1]))}voronoi(t){return new gt(this,t)}*neighbors(t){const{inedges:e,hull:n,_hullIndex:i,halfedges:r,triangles:s,collinear:o}=this;if(o){const e=o.indexOf(t);return e>0&&(yield o[e-1]),void(e<o.length-1&&(yield o[e+1]))}const a=e[t];if(-1===a)return;let l=a,h=-1;do{if(yield h=s[l],l=l%3==2?l-2:l+1,s[l]!==t)return;if(l=r[l],-1===l){const e=n[(i[t]+1)%n.length];return void(e!==h&&(yield e))}}while(l!==a)}find(t,e,n=0){if((t=+t)!=t||(e=+e)!=e)return-1;const i=n;let r;for(;(r=this._step(n,t,e))>=0&&r!==n&&r!==i;)n=r;return r}_step(t,e,n){const{inedges:i,hull:r,_hullIndex:s,halfedges:o,triangles:a,points:l}=this;if(-1===i[t]||!l.length)return(t+1)%(l.length>>1);let h=t,c=yt(e-l[2*t],2)+yt(n-l[2*t+1],2);const u=i[t];let d=u;do{let i=a[d];const u=yt(e-l[2*i],2)+yt(n-l[2*i+1],2);if(u<c&&(c=u,h=i),d=d%3==2?d-2:d+1,a[d]!==t)break;if(d=o[d],-1===d){if(d=r[(s[t]+1)%r.length],d!==i&&yt(e-l[2*d],2)+yt(n-l[2*d+1],2)<c)return d;break}}while(d!==u);return h}render(t){const e=null==t?t=new pt:void 0,{points:n,halfedges:i,triangles:r}=this;for(let e=0,s=i.length;e<s;++e){const s=i[e];if(s<e)continue;const o=2*r[e],a=2*r[s];t.moveTo(n[o],n[o+1]),t.lineTo(n[a],n[a+1])}return this.renderHull(t),e&&e.value()}renderPoints(t,e){void 0!==e||t&&"function"==typeof t.moveTo||(e=t,t=null),e=null==e?2:+e;const n=null==t?t=new pt:void 0,{points:i}=this;for(let n=0,r=i.length;n<r;n+=2){const r=i[n],s=i[n+1];t.moveTo(r+e,s),t.arc(r,s,e,0,mt)}return n&&n.value()}renderHull(t){const e=null==t?t=new pt:void 0,{hull:n,points:i}=this,r=2*n[0],s=n.length;t.moveTo(i[r],i[r+1]);for(let e=1;e<s;++e){const r=2*n[e];t.lineTo(i[r],i[r+1])}return t.closePath(),e&&e.value()}hullPolygon(){const t=new _t;return this.renderHull(t),t.value()}renderTriangle(t,e){const n=null==e?e=new pt:void 0,{points:i,triangles:r}=this,s=2*r[t*=3],o=2*r[t+1],a=2*r[t+2];return e.moveTo(i[s],i[s+1]),e.lineTo(i[o],i[o+1]),e.lineTo(i[a],i[a+1]),e.closePath(),n&&n.value()}*trianglePolygons(){const{triangles:t}=this;for(let e=0,n=t.length/3;e<n;++e)yield this.trianglePolygon(e)}trianglePolygon(t){const e=new _t;return this.renderTriangle(t,e),e.value()}}function At(t,e,n){let i,r;this.update=function(){i=e.getCandidates();const t=i.map((t=>[t.x,t.y])),s=bt.from(t);r=s.voronoi([0,0,n.width,n.height])},this.render=function(){const{ctx:e}=n;e.save(),e.beginPath(),e.arc(t.x,t.y,t.r,0,2*Math.PI),e.clip();const s=i.length;for(let t=0;t<s;t++)e.beginPath(),r.renderCell(t,e),e.fillStyle=i[t].square.color,e.fill(),e.stroke();e.beginPath(),e.arc(t.x,t.y,t.r,0,2*Math.PI),e.stroke(),e.restore()}}function kt(t,e,n,i,r,s){const o=this;o.x=t,o.y=e,o.r=n,o.setX=function(t){o.x=t},o.setY=function(t){o.y=t};const a=new Y(o,10,"#555",i);o.circle=a,r.newCircleHandle(o,a),s.newVoterGroup(o);const l=new At(o,s,i);o.update=function(){l.update()},o.render=function(){l.render(),a.render()}}function St(t,e,n,i,r){const s=this;s.w=e,s.h=n,s.trueW=e,s.trueH=n,s.color=i,s.pickUp=function(){s.tweenSq=new W(s),s.tweenSq.to({w:s.trueW+10,h:s.trueH+10},100),s.tweenSq.start()},s.drop=function(){s.tweenSq=new W(s),s.tweenSq.to({w:s.trueW,h:s.trueH},100),s.tweenSq.start()},s.render=function(){const{ctx:e}=r;s.tweenSq&&s.tweenSq.update(),e.beginPath(),e.fillStyle=s.color,e.rect(t.x-.5*s.w-.5,t.y-.5*s.h-.5,s.w+1,s.h+1),e.fill(),e.stroke()}}function Mt(t,e,n,i,r,s,o,a){const l=this;l.x=t,l.y=e,l.setX=function(t){l.x=t},l.setY=function(t){l.y=t};const h=new St(l,n,i,r,s);l.square=h,o.newSquareHandle(l,h),a.newCandidate(l),l.fraction=0,l.setFraction=function(t){l.fraction=t},l.render=function(){h.render(),function(t,e,n,i,r,s,o,a){o.save(),o.textAlign=a||"center",o.font=`${i}px Sans-serif`,o.lineWidth=r,o.fillStyle=s,o.fillText(t,e,n),o.restore()}((100*l.fraction).toFixed(0),l.x,l.y-.5*h.h-2,20,2,"#222",s.ctx)}}function Ct(t,e,n,i,r){const s=new Mt(100,200,21,21,"#e52",t,e,r),o=new Mt(200,100,21,21,"#5e2",t,e,r),a=new Mt(400,500,21,21,"#25e",t,e,r),l=new kt(100,300,200,t,e,r),h=new kt(500,300,200,t,e,r);this.update=()=>{i.checkNone()||(i.clear(),r.updateTallies(),l.update(),h.update())},this.render=()=>{l.render(),h.render(),s.render(),o.render(),a.render()}}function Tt(t,e,n,i,r,s){const o=this;o.x=t,o.y=e,o.r=n,o.setX=function(t){o.x=t},o.setY=function(t){o.y=t};const a=new Y(o,10,"#555",i);o.circle=a,r.newCircleHandle(o,a),s.newVoterGroup(o),o.update=function(){},o.render=function(){const{ctx:t}=i;t.beginPath(),t.arc(o.x,o.y,o.r,0,2*Math.PI),t.stroke(),a.render()}}function Et(t,e,n,i,r,s){const o=this;o.x=t,o.y=e,o.r=n,o.setX=function(t){o.x=t},o.setY=function(t){o.y=t};const a=new St(o,10,10,"#ccc",i);o.square=a,r.newSquareHandle(o,a),s.newCandidateDistribution(o),o.render=function(){const{ctx:t}=i;t.beginPath(),t.arc(o.x,o.y,o.r,0,2*Math.PI),t.stroke(),a.render()}}function Pt(t,e,n,i,r){const s=new Et(300,300,400,t,e,r),o=new Tt(100,300,200,t,e,r),a=new Tt(500,300,200,t,e,r);this.update=()=>{i.checkNone()?r.addSim():(i.clear(),r.startSim(),o.update(),a.update())},this.render=()=>{r.render(),o.render(),a.render(),s.render()}}function It(t,e,n,i,r,s,o){const a=this;i.add(["simType"]);const l={one:{},many:{}};a.state=o,a.typeExit=a.state,a.update=()=>{i.check(["simType"])&&(e.clear(),r.clear(),"one"===a.state?l[a.state]=new Ct(t,e,n,i,r):l[a.state]=new Pt(t,e,n,i,s)),l[a.state].update()},a.render=()=>{l[a.state].render()},a.typeList=[{name:"One Election",value:"one",state:""},{name:"Many Elections",value:"many",state:""}],n.addMenuItem(a,{label:"Simulation:",prop:"state",setProp:t=>{a.state=t},options:a.typeList,change:["simType"]})}function Ot(t){const e=function(t){const e=t.map((t=>t.r**2)),n=e.reduce(((t,e)=>t+e)),i=e.map((t=>t/n)),r=[];return i.reduce(((t,e,n)=>{const i=t+e;return r[n]=i,i}),0),r}(t);this.samplePoint=function(){return function(t,e){const n=function(t){const e=Math.random();return t.findIndex((t=>t>=e))}(e),i=t[n];return function(t,e,n){const i=n*Math.sqrt(Math.random()),r=2*Math.random()*Math.PI,s=t+i*Math.cos(r),o=e+i*Math.sin(r);return{x:s,y:o}}(i.x,i.y,i.r)}(t,e)}}function Nt(t,e,n){n.newCandidate({x:t,y:e})}function Rt(t,e,n){const i=this;i.points=[],i.newPoints=[];const r=[];i.newVoterGroup=function(t){n.newVoterGroup(t)},i.newCandidateDistribution=function(t){r.push(t)},i.startSim=function(){i.sampler=new Ot(r),i.points=[],o.clearRect(0,0,s.width,s.height)},i.addSim=function(){if(i.points.length>5e3)return;for(let t=0;t<20;t++){let t;"singleWinner"===n.method.checkElectionType()?t=5:"allocation"===n.method.checkElectionType()&&(t=10);for(let e=0;e<t;e++){const t=i.sampler.samplePoint();Nt(t.x,t.y,n)}const e=n.runElection();if("singleWinner"===n.method.checkElectionType()){const{winner:t}=e,n={x:t.x,y:t.y};i.points.push(n),i.newPoints.push(n)}else{const{allocation:t,candidates:n}=e,r=100;n.forEach(((e,n)=>{const s=t[n];for(let t=0;t<s;t++){let n;n=0===t?{x:e.x,y:e.y}:{x:e.x+(Math.random()-.5)*r,y:e.y+(Math.random()-.5)*r},i.points.push(n),i.newPoints.push(n)}}))}n.clearCandidates()}a(o,i.newPoints),i.newPoints=[]};const s=document.createElement("canvas");s.width=t.canvas.width,s.height=t.canvas.height;const o=s.getContext("2d");function a(t,e){t.fillStyle="grey";const n=e.length;for(let i=0;i<n;i++){const n=e[i];t.beginPath(),t.arc(n.x,n.y,3,0,2*Math.PI),t.fill()}}i.render=function(){t.noBuffers?i.noBufferRender():i.bufferRender()},i.bufferRender=function(){const{ctx:e}=t;e.drawImage(s,0,0)},i.noBufferRender=function(){const{ctx:e}=t;a(e,i.points)}}function Dt(i){const{initialState:r}=i,s=new t,o=new g(s),a=new n(600,600),l=d(a,_),h=new e(a,s),c=new k(o),u=new Rt(a,o,c),f=new It(a,h,o,s,c,u,r),p=function(t,e,n){const i=document.createElement("div");return i.appendChild(t.divMenu),i.appendChild(e.canvas),i.appendChild(n),i}(o,a,l);function _(){a.clear(),f.render()}return window.requestAnimationFrame((function t(){f.update(),_(),window.requestAnimationFrame(t)})),p}Array.from(document.getElementsByClassName("sandbox")).forEach((t=>{const e=Dt({initialState:t.dataset.initialstate});t.parentNode.appendChild(e)}));
//# sourceMappingURL=404.a4d2f257.js.map
